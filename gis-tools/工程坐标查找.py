import tkinter as tk
from tkinter import ttk, messagebox

# 坐标数据
coordinate_data = {
    "无量山特长隧道": {
        "description": "A独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1870米",
        "points": {
            "D004": {"X": 2741862.521, "Y": 522716.669, "高程": 1845.066, "等级": "二等"},
            "D005": {"X": 2741151.302, "Y": 522139.640, "高程": 1722.599, "等级": "二等"},
            "D008": {"X": 2736743.384, "Y": 515553.117, "高程": 1725.044, "等级": "二等"},
            "I017": {"X": 2737305.466, "Y": 515860.633, "高程": 1812.282, "等级": "二等"},
            "Y001": {"X": 2742192.128, "Y": 522253.951, "高程": 1869.575, "等级": "二等"},
            "Y002": {"X": 2741898.571, "Y": 522517.837, "高程": 1815.861, "等级": "二等"},
            "Y003": {"X": 2741472.837, "Y": 522099.191, "高程": 1717.875, "等级": "二等"},
            "Y004": {"X": 2737694.716, "Y": 516140.002, "高程": 1821.566, "等级": "二等"},
            "Y005": {"X": 2737339.632, "Y": 516073.319, "高程": 1837.153, "等级": "二等"},
            "Y006": {"X": 2737003.621, "Y": 515637.909, "高程": 1756.540, "等级": "二等"},
            "D01": {"X": 2745914.152, "Y": 523299.379, "高程": 1763.873, "等级": "四等"},
            "D02": {"X": 2746318.957, "Y": 523301.746, "高程": 1779.483, "等级": "四等"},
            "D03": {"X": 2745960.884, "Y": 522668.223, "高程": 1761.851, "等级": "四等"},
            "D06": {"X": 2738437.895, "Y": 517981.921, "高程": 2017.795, "等级": "四等"},
            "D07": {"X": 2738836.445, "Y": 517413.414, "高程": 1993.838, "等级": "四等"},
            "D09": {"X": 2736072.169, "Y": 515040.320, "高程": 1738.366, "等级": "四等"},
            "D10": {"X": 2732388.768, "Y": 517868.620, "高程": 1685.373, "等级": "四等"},
            "D11": {"X": 2732031.826, "Y": 517503.115, "高程": 1719.206, "等级": "四等"},
            "I01": {"X": 2744748.726, "Y": 522590.639, "高程": 1708.224, "等级": "四等"},
            "I02": {"X": 2744615.927, "Y": 522138.354, "高程": 1759.115, "等级": "四等"},
            "I03": {"X": 2743729.912, "Y": 522665.142, "高程": 1961.054, "等级": "四等"},
            "I04": {"X": 2742797.812, "Y": 522579.316, "高程": 2111.873, "等级": "四等"},
            "I05": {"X": 2742394.335, "Y": 522156.187, "高程": 1893.317, "等级": "四等"},
            "I06": {"X": 2741185.376, "Y": 521988.614, "高程": 1795.450, "等级": "四等"},
            "I07": {"X": 2741007.245, "Y": 521272.628, "高程": 2082.447, "等级": "四等"},
            "I08": {"X": 2740731.117, "Y": 520772.464, "高程": 2020.870, "等级": "四等"},
            "I09": {"X": 2740160.963, "Y": 520679.519, "高程": 1923.810, "等级": "四等"},
            "I10": {"X": 2740341.699, "Y": 520030.579, "高程": 1914.470, "等级": "四等"},
            "I11": {"X": 2738064.723, "Y": 519399.528, "高程": 2271.929, "等级": "四等"},
            "I12": {"X": 2736843.076, "Y": 518579.424, "高程": 2223.926, "等级": "四等"},
            "I13": {"X": 2738865.005, "Y": 516993.363, "高程": 1944.284, "等级": "四等"},
            "I14": {"X": 2738288.584, "Y": 516619.267, "高程": 1823.237, "等级": "四等"},
            "I15": {"X": 2738537.493, "Y": 515611.679, "高程": 1877.530, "等级": "四等"},
            "I16": {"X": 2738236.188, "Y": 514986.828, "高程": 1875.812, "等级": "四等"},
            "I17": {"X": 2737069.535, "Y": 514721.146, "高程": 1504.760, "等级": "四等"},
            "I18": {"X": 2736026.120, "Y": 515875.373, "高程": 1858.054, "等级": "四等"},
            "I19": {"X": 2733653.408, "Y": 516525.995, "高程": 1722.509, "等级": "四等"},
            "I20": {"X": 2733840.190, "Y": 517078.529, "高程": 2020.314, "等级": "四等"},
            "I21": {"X": 2732388.768, "Y": 517868.620, "高程": 1685.373, "等级": "四等"},
        }
    },
    "澜沧江大桥": {
        "description": "CD独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1050米",
        "points": {
            "D018": {"X": 2715013.239, "Y": 518566.887, "高程": 961.690, "等级": "三等"},
            "D019": {"X": 2715271.126, "Y": 517926.360, "高程": 909.212, "等级": "三等"},
            "Y007": {"X": 2716581.742, "Y": 518048.618, "高程": 907.764, "等级": "三等"},
            "Y008": {"X": 2715868.918, "Y": 518385.225, "高程": 905.948, "等级": "三等"},
            "Y009": {"X": 2716704.750, "Y": 517830.621, "高程": 899.643, "等级": "三等"},
            "Y010": {"X": 2716262.912, "Y": 518045.200, "高程": 914.448, "等级": "三等"},
        }
    },
    "周家村隧道": {
        "description": "CD独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1050米",
        "points": {
            "D021": {"X": 2712729.622, "Y": 515748.970, "高程": 968.381, "等级": "三等"},
            "GD96": {"X": 2710519.670, "Y": 512185.698, "高程": 976.900, "等级": "三等"},
            "Y012": {"X": 2712143.194, "Y": 515346.397, "高程": 984.742, "等级": "三等"},
            "Y013": {"X": 2712279.816, "Y": 515243.245, "高程": 939.321, "等级": "三等"},
            "Y014": {"X": 2710612.824, "Y": 512680.799, "高程": 979.054, "等级": "三等"},
            "Y015": {"X": 2710457.045, "Y": 512520.517, "高程": 972.901, "等级": "三等"},
        }
    },
    "丙令河隧道": {
        "description": "CD独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1050米",
        "points": {
            "GD71": {"X": 2709728.342, "Y": 508225.938, "高程": 997.331, "等级": "三等"},
            "GD73": {"X": 2709541.441, "Y": 503473.223, "高程": 1021.468, "等级": "三等"},
            "Y016": {"X": 2710096.845, "Y": 508619.860, "高程": 1092.749, "等级": "三等"},
            "Y017": {"X": 2710016.298, "Y": 508597.673, "高程": 1048.204, "等级": "三等"},
            "Y018": {"X": 2710624.755, "Y": 504486.263, "高程": 1206.355, "等级": "三等"},
            "Y019": {"X": 2710393.520, "Y": 504460.014, "高程": 1185.479, "等级": "三等"},
        }
    },
    "德胜大桥": {
        "description": "CD独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1050米",
        "points": {
            "GD84": {"X": 2710107.825, "Y": 484669.095, "高程": 1116.178, "等级": "三等"},
            "E155": {"X": 2710036.824, "Y": 483125.253, "高程": 1142.028, "等级": "三等"},
            "Y020": {"X": 2710620.863, "Y": 483920.327, "高程": 1113.500, "等级": "三等"},
            "Y021": {"X": 2710421.924, "Y": 483543.440, "高程": 1136.087, "等级": "三等"},
            "Y022": {"X": 2710363.979, "Y": 483416.067, "高程": 1140.017, "等级": "三等"},
        }
    },
    "B独立坐标系": {
        "description": "B独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1350米",
        "points": {
            "D11": {"X": 2732031.826, "Y": 517603.115, "高程": 1719.206, "等级": "四等"},
            "D12": {"X": 2727655.033, "Y": 517462.965, "高程": 1332.839, "等级": "四等"},
            "D13": {"X": 2727179.123, "Y": 518094.479, "高程": 1445.335, "等级": "四等"},
            "D14": {"X": 2723069.173, "Y": 519644.528, "高程": 1248.607, "等级": "四等"},
            "D15": {"X": 2722522.379, "Y": 520315.802, "高程": 1227.233, "等级": "四等"},
            "I22": {"X": 2729442.419, "Y": 518191.875, "高程": 1420.557, "等级": "四等"},
            "I23": {"X": 2729068.612, "Y": 517667.496, "高程": 1373.578, "等级": "四等"},
            "I24": {"X": 2727745.771, "Y": 518107.003, "高程": 1441.379, "等级": "四等"},
            "I25": {"X": 2726378.590, "Y": 519223.657, "高程": 1464.329, "等级": "四等"},
            "I26": {"X": 2725929.234, "Y": 518844.715, "高程": 1443.516, "等级": "四等"},
            "I27": {"X": 2725634.848, "Y": 519328.469, "高程": 1312.533, "等级": "四等"},
            "I28": {"X": 2724879.650, "Y": 519469.239, "高程": 1304.939, "等级": "四等"},
            "I29": {"X": 2724936.640, "Y": 518525.668, "高程": 1246.614, "等级": "四等"},
            "I30": {"X": 2724365.455, "Y": 518971.850, "高程": 1210.626, "等级": "四等"},
            "I31": {"X": 2723356.066, "Y": 520044.597, "高程": 1253.832, "等级": "四等"},
            "I32": {"X": 2721912.436, "Y": 520017.538, "高程": 1280.224, "等级": "四等"},
            "I33": {"X": 2721496.626, "Y": 520467.277, "高程": 1248.065, "等级": "四等"},
            "I34": {"X": 2721002.082, "Y": 519553.997, "高程": 1245.205, "等级": "四等"},
            "I35": {"X": 2721116.456, "Y": 519147.869, "高程": 1193.413, "等级": "四等"},
            "I36": {"X": 2720554.460, "Y": 519150.606, "高程": 1181.325, "等级": "四等"},
        }
    },
    "CD独立坐标系": {
        "description": "CD独立坐标系，CGCS2000椭球，中央子午线100°19′，投影高1050米",
        "points": {
            "D016": {"X": 2718349.853, "Y": 520422.682, "高程": 1035.623, "等级": "四等"},
            "D017": {"X": 2717771.158, "Y": 520465.211, "高程": 1058.077, "等级": "四等"},
            "D020": {"X": 2713270.709, "Y": 516153.704, "高程": 1002.188, "等级": "四等"},
            "I37": {"X": 2720146.951, "Y": 519800.720, "高程": 1201.367, "等级": "四等"},
            "I38": {"X": 2718948.157, "Y": 519991.331, "高程": 1140.657, "等级": "四等"},
            "I39": {"X": 2718809.685, "Y": 520502.287, "高程": 1042.113, "等级": "四等"},
            "I40": {"X": 2718534.779, "Y": 519801.965, "高程": 1155.404, "等级": "四等"},
            "I41": {"X": 2717810.564, "Y": 520762.808, "高程": 1033.586, "等级": "四等"},
            "I42": {"X": 2716859.897, "Y": 520372.097, "高程": 1050.180, "等级": "四等"},
            "I43": {"X": 2716063.866, "Y": 519940.587, "高程": 1019.346, "等级": "四等"},
            "I44": {"X": 2716517.003, "Y": 520226.324, "高程": 1035.244, "等级": "四等"},
            "I45": {"X": 2715763.198, "Y": 519527.541, "高程": 1010.334, "等级": "四等"},
            "I46": {"X": 2715220.797, "Y": 519072.024, "高程": 980.759, "等级": "四等"},
            "I47": {"X": 2715535.005, "Y": 518479.392, "高程": 901.037, "等级": "四等"},
            "I48": {"X": 2714886.947, "Y": 517382.406, "高程": 909.191, "等级": "四等"},
            "I49": {"X": 2713954.371, "Y": 516934.104, "高程": 951.839, "等级": "四等"},
            "I50": {"X": 2713314.542, "Y": 517276.089, "高程": 1026.664, "等级": "四等"},
            "GD61": {"X": 2713063.299, "Y": 516499.480, "高程": 932.505, "等级": "四等"},
            "GD62": {"X": 2712823.667, "Y": 516322.986, "高程": 954.541, "等级": "四等"},
            "GD63": {"X": 2712896.335, "Y": 515778.295, "高程": 920.038, "等级": "四等"},
            "GD65": {"X": 2711942.996, "Y": 513415.846, "高程": 977.206, "等级": "四等"},
            "GD66": {"X": 2711923.863, "Y": 513246.460, "高程": 978.431, "等级": "四等"},
            "GD67": {"X": 2711761.558, "Y": 513013.111, "高程": 979.872, "等级": "四等"},
            "GD68": {"X": 2711327.040, "Y": 511283.092, "高程": 979.504, "等级": "四等"},
            "GD69": {"X": 2711435.872, "Y": 510636.210, "高程": 982.564, "等级": "四等"},
            "GD70": {"X": 2709867.993, "Y": 508888.389, "高程": 993.381, "等级": "四等"},
            "GD72": {"X": 2709777.609, "Y": 504073.403, "高程": 1018.714, "等级": "四等"},
            "GD74": {"X": 2709830.862, "Y": 502080.637, "高程": 1016.323, "等级": "四等"},
            "GD75": {"X": 2710281.604, "Y": 501600.149, "高程": 1017.086, "等级": "四等"},
            "GD76": {"X": 2710413.251, "Y": 500593.372, "高程": 1017.618, "等级": "四等"},
            "GD77": {"X": 2710394.018, "Y": 499846.602, "高程": 1068.974, "等级": "四等"},
            "GD78": {"X": 2712217.980, "Y": 493623.245, "高程": 1035.461, "等级": "四等"},
            "GD79": {"X": 2711812.245, "Y": 493168.530, "高程": 1032.014, "等级": "四等"},
            "GD80": {"X": 2709587.395, "Y": 489716.225, "高程": 1128.680, "等级": "四等"},
            "GD81": {"X": 2709434.239, "Y": 489318.482, "高程": 1172.562, "等级": "四等"},
            "GD82": {"X": 2710251.107, "Y": 485413.794, "高程": 1143.130, "等级": "四等"},
            "GD83": {"X": 2710035.827, "Y": 485017.948, "高程": 1122.441, "等级": "四等"},
            "GD85": {"X": 2708152.215, "Y": 481436.566, "高程": 1192.458, "等级": "四等"},
            "GD86": {"X": 2707755.980, "Y": 481561.618, "高程": 1165.010, "等级": "四等"},
            "GD87": {"X": 2705458.490, "Y": 478808.966, "高程": 1139.338, "等级": "四等"},
            "GD88": {"X": 2704994.531, "Y": 479115.060, "高程": 1136.946, "等级": "四等"},
            "GD89": {"X": 2704381.151, "Y": 478678.080, "高程": 1104.389, "等级": "四等"},
            "GD90": {"X": 2704114.863, "Y": 478283.818, "高程": 1081.113, "等级": "四等"},
            "E101": {"X": 2710966.794, "Y": 510288.084, "高程": 981.617, "等级": "四等"},
            "E102": {"X": 2710506.691, "Y": 509831.861, "高程": 977.572, "等级": "四等"},
            "E132": {"X": 2709951.304, "Y": 509175.804, "高程": 994.346, "等级": "四等"},
            "E133": {"X": 2709700.839, "Y": 507415.756, "高程": 1018.548, "等级": "四等"},
            "E134": {"X": 2709785.753, "Y": 506846.396, "高程": 1011.145, "等级": "四等"},
            "E135": {"X": 2709928.264, "Y": 506073.790, "高程": 1018.007, "等级": "四等"},
            "E136": {"X": 2709988.137, "Y": 505660.777, "高程": 1023.611, "等级": "四等"},
            "E137": {"X": 2709972.774, "Y": 505141.346, "高程": 1022.252, "等级": "四等"},
            "E138": {"X": 2709973.546, "Y": 504786.868, "高程": 1017.199, "等级": "四等"},
            "E139": {"X": 2710455.176, "Y": 501146.406, "高程": 1017.160, "等级": "四等"},
            "E140": {"X": 2710576.598, "Y": 498692.611, "高程": 1028.316, "等级": "四等"},
            "E141": {"X": 2710533.724, "Y": 498332.885, "高程": 1024.758, "等级": "四等"},
            "E142": {"X": 2710570.642, "Y": 498069.346, "高程": 1030.944, "等级": "四等"},
            "E143": {"X": 2711039.610, "Y": 496950.776, "高程": 1027.962, "等级": "四等"},
            "E144": {"X": 2711508.468, "Y": 496244.553, "高程": 1028.603, "等级": "四等"},
            "E145": {"X": 2711839.448, "Y": 496211.748, "高程": 1032.209, "等级": "四等"},
            "E146": {"X": 2712017.631, "Y": 494595.582, "高程": 1031.826, "等级": "四等"},
            "E147": {"X": 2712062.824, "Y": 495287.460, "高程": 1031.826, "等级": "四等"},
            "E148": {"X": 2711209.139, "Y": 492762.093, "高程": 1060.617, "等级": "四等"},
            "E149": {"X": 2711190.743, "Y": 492984.249, "高程": 1080.523, "等级": "四等"},
            "E150": {"X": 2710816.904, "Y": 491900.025, "高程": 1102.653, "等级": "四等"},
            "E151": {"X": 2710808.518, "Y": 491128.577, "高程": 1069.226, "等级": "四等"},
            "E152": {"X": 2710175.571, "Y": 490590.681, "高程": 1119.397, "等级": "四等"},
            "E154": {"X": 2710164.102, "Y": 483488.243, "高程": 1124.513, "等级": "四等"},
            "E156": {"X": 2709166.534, "Y": 482705.830, "高程": 1125.262, "等级": "四等"},
            "E157": {"X": 2708804.382, "Y": 482058.305, "高程": 1158.640, "等级": "四等"},
            "E158": {"X": 2706795.748, "Y": 480256.806, "高程": 1150.357, "等级": "四等"},
            "E159": {"X": 2706585.752, "Y": 480047.124, "高程": 1139.034, "等级": "四等"},
            "E160": {"X": 2706103.159, "Y": 479569.898, "高程": 1104.532, "等级": "四等"},
        }
    },
    "起点互通枢纽": {
        "description": "南景线工程坐标系，CGCS2000椭球，中央子午线100°42′，投影高1700米",
        "points": {
            "I72": {"X": 2746889.569, "Y": 483113.181, "高程": 1709.083, "等级": "四等"},
            "I73": {"X": 2746464.232, "Y": 483205.346, "高程": 1695.962, "等级": "四等"},
            "D01": {"X": 2745218.046, "Y": 484537.502, "高程": 1764.056, "等级": "四等"},
            "D02": {"X": 2745622.829, "Y": 484541.006, "高程": 1779.666, "等级": "四等"},
        }
    },
    "终点互通枢纽": {
        "description": "云凤线工程坐标系，CGCS2000椭球，中央子午线100°00′，投影高1150米",
        "points": {
            "YF23": {"X": 2703912.811, "Y": 510593.343, "高程": 1079.977, "等级": "四等"},
            "D001": {"X": 2703509.554, "Y": 511204.459, "高程": 1078.541, "等级": "四等"},
            "GD88": {"X": 2704781.513, "Y": 511119.435, "高程": 1136.929, "等级": "四等"},
            "GD89": {"X": 2704167.120, "Y": 510683.862, "高程": 1104.372, "等级": "四等"},
        }
    }
}

class CoordinateFinderApp:
    def __init__(self, root):
        self.root = root
        self.root.title("工程坐标查找系统")
        self.root.geometry("1200x800")
        
        # 创建主框架
        self.main_frame = ttk.Frame(root, padding="10")
        self.main_frame.pack(fill=tk.BOTH, expand=True)
        
        # 搜索框架
        self.search_frame = ttk.LabelFrame(self.main_frame, text="搜索选项", padding="10")
        self.search_frame.pack(fill=tk.X, pady=5)
        
        # 项目选择
        ttk.Label(self.search_frame, text="选择项目:").grid(row=0, column=0, padx=5, pady=5, sticky=tk.W)
        self.project_var = tk.StringVar()
        self.project_combobox = ttk.Combobox(self.search_frame, textvariable=self.project_var, 
                                           values=list(coordinate_data.keys()), state="readonly")
        self.project_combobox.grid(row=0, column=1, padx=5, pady=5, sticky=tk.W)
        self.project_combobox.bind("<<ComboboxSelected>>", self.update_point_list)
        
        # 点号搜索
        ttk.Label(self.search_frame, text="搜索点号:").grid(row=1, column=0, padx=5, pady=5, sticky=tk.W)
        self.point_var = tk.StringVar()
        self.point_entry = ttk.Entry(self.search_frame, textvariable=self.point_var)
        self.point_entry.grid(row=1, column=1, padx=5, pady=5, sticky=tk.W)
        self.point_entry.bind("<KeyRelease>", self.search_points)
        
        # 搜索按钮
        self.search_button = ttk.Button(self.search_frame, text="搜索", command=self.search_points)
        self.search_button.grid(row=1, column=2, padx=5, pady=5)
        
        # 结果显示框架
        self.result_frame = ttk.LabelFrame(self.main_frame, text="坐标信息", padding="10")
        self.result_frame.pack(fill=tk.BOTH, expand=True, pady=5)
        
        # 项目描述
        self.description_label = ttk.Label(self.result_frame, text="", wraplength=700)
        self.description_label.pack(fill=tk.X, pady=5)
        
        # 创建Treeview显示结果
        self.tree = ttk.Treeview(self.result_frame, columns=("点号", "X坐标", "Y坐标", "高程", "等级"), show="headings")
        self.tree.heading("点号", text="点号")
        self.tree.heading("X坐标", text="X坐标 (m)")
        self.tree.heading("Y坐标", text="Y坐标 (m)")
        self.tree.heading("高程", text="高程 (m)")
        self.tree.heading("等级", text="等级")
        
        self.tree.column("点号", width=100, anchor=tk.CENTER)
        self.tree.column("X坐标", width=150, anchor=tk.CENTER)
        self.tree.column("Y坐标", width=150, anchor=tk.CENTER)
        self.tree.column("高程", width=100, anchor=tk.CENTER)
        self.tree.column("等级", width=80, anchor=tk.CENTER)
        
        self.tree.pack(fill=tk.BOTH, expand=True)
        
        # 添加滚动条
        scrollbar = ttk.Scrollbar(self.tree, orient="vertical", command=self.tree.yview)
        scrollbar.pack(side="right", fill="y")
        self.tree.configure(yscrollcommand=scrollbar.set)
        
        # 初始化显示所有数据
        self.project_combobox.current(0)
        self.update_point_list()
        
    def update_point_list(self, event=None):
        selected_project = self.project_var.get()
        if selected_project:
            project_data = coordinate_data[selected_project]
            self.description_label.config(text=project_data["description"])
            self.display_points(project_data["points"])
    
    def display_points(self, points_dict):
        # 清空当前显示
        for item in self.tree.get_children():
            self.tree.delete(item)
        
        # 按点号排序
        sorted_points = sorted(points_dict.items(), key=lambda x: x[0])
        
        # 添加数据到Treeview
        for point_id, data in sorted_points:
            self.tree.insert("", "end", values=(
                point_id,
                f"{data['X']:.3f}",
                f"{data['Y']:.3f}",
                f"{data['高程']:.3f}",
                data["等级"]
            ))
    
    def search_points(self, event=None):
        search_term = self.point_var.get().upper().strip()
        selected_project = self.project_var.get()
        
        if not selected_project:
            return
        
        project_data = coordinate_data[selected_project]
        all_points = project_data["points"]
        
        if not search_term:
            self.display_points(all_points)
            return
        
        # 筛选匹配的点
        matched_points = {}
        for point_id, data in all_points.items():
            if search_term in point_id:
                matched_points[point_id] = data
        
        if matched_points:
            self.display_points(matched_points)
        else:
            messagebox.showinfo("提示", f"未找到包含 '{search_term}' 的点号")
            self.display_points(all_points)

def main():
    root = tk.Tk()
    app = CoordinateFinderApp(root)
    root.mainloop()

if __name__ == "__main__":
    main()
